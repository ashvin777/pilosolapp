[{"id":"b42fd12f.306d4","type":"tab","label":"Run only firstime","disabled":false,"info":""},{"id":"c314f908.4e5ca8","type":"tab","label":"api","disabled":false,"info":""},{"id":"650555c9.ffd16c","type":"tab","label":"modbus input","disabled":false,"info":""},{"id":"51972b56.ca0314","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"60e8797.d0c1b88","type":"postgresDB","z":"","name":"localhost","host":"localhost","port":"5432","database":"postgres","ssl":false,"max":"10","min":1,"idle":"1000"},{"id":"a68af64b.1b0c68","type":"inject","z":"b42fd12f.306d4","name":"inject on start","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"x":133.52777099609375,"y":46.95834255218506,"wires":[["4b5626d9.66cb18"]]},{"id":"4b5626d9.66cb18","type":"postgrestor","z":"b42fd12f.306d4","name":"create tables","query":"CREATE TABLE frames (\n    id bigserial NOT NULL,\n name text NOT NULL,\n serial text,\nPRIMARY KEY (ID)\n);\n\nCREATE TABLE components (\n\tid bigserial NOT NULL,\n\tname  text NOT NULL,\n\tframeId bigserial REFERENCES frames(id),\n\tPRIMARY KEY (ID)\n);\n\nCREATE TABLE logs (\n\tid bigserial NOT NULL,\n\tframeType text NOT NULL,\n\tframeNumber text,\n\tframeComponent text NOT NULL,\n\tshiftNumber text NOT NULL,\n\tprocessingTime text NOT NULL,\n\tstatus text NOT NULL,\n\ttimestamp text NOT NULL,\n\tPRIMARY KEY (ID)\n);\n\nCREATE TABLE shifts (\n\tid bigserial NOT NULL,\n\tname text NOT NULL,\n\tstartTime text NOT NULL,\n\tendTime text NOT NULL\n);\n\nCREATE TABLE users (\n\tid integer NOT NULL,\n\tusername text NOT NULL,\n\tpassword text NOT NULL\n);\n\nCREATE INDEX idx_frames ON frames(id);\nCREATE INDEX idx_components ON components(id);\nCREATE INDEX idx_logs ON logs(id);\nCREATE INDEX idx_users ON users(id);","postgresDB":"60e8797.d0c1b88","output":true,"outputs":1,"x":336.5174255371094,"y":156.8680877685547,"wires":[["91a0292b.543018","3c9f0b87.37d0e4"]]},{"id":"7dd12653.8ce8e8","type":"http in","z":"c314f908.4e5ca8","name":"","url":"/users","method":"get","upload":false,"swaggerDoc":"","x":107.52777099609375,"y":117.78820037841797,"wires":[["4f2bf7a1.7e0328"]]},{"id":"4f2bf7a1.7e0328","type":"postgrestor","z":"c314f908.4e5ca8","name":"get users","query":"SELECT * FROM USERS;","postgresDB":"60e8797.d0c1b88","output":true,"outputs":1,"x":335.5208740234375,"y":106.87152862548828,"wires":[["5f6717a7.b12528"]]},{"id":"bc77d064.4f848","type":"http response","z":"c314f908.4e5ca8","name":"","statusCode":"","headers":{},"x":855.5244407653809,"y":99.87506103515625,"wires":[]},{"id":"5f6717a7.b12528","type":"change","z":"c314f908.4e5ca8","name":"","rules":[{"t":"set","p":"users","pt":"global","to":"payload.rows","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"payload.rows","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":605.5139007568359,"y":108.10771560668945,"wires":[["bc77d064.4f848"]]},{"id":"91a0292b.543018","type":"postgrestor","z":"b42fd12f.306d4","name":"insert users","query":"INSERT INTO USERS(id, username, password)\nVALUES(1, 'admin', 'admin');","postgresDB":"60e8797.d0c1b88","output":true,"outputs":1,"x":540.0173187255859,"y":241.01044464111328,"wires":[[]]},{"id":"733722d6.0c4d1c","type":"postgrestor","z":"b42fd12f.306d4","name":"insert components","query":"\nINSERT INTO components(id, name, frameid) \nVALUES \n  (1, 'component1', 1);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (2, 'component2', 1);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (3, 'component3', 1);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (4, 'component1', 1);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (5, 'component2', 1);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (6, 'component3', 1);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (7, 'component1', 1);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (8, 'component2', 1);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (9, 'component3', 1);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (10, 'component1', 1);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (11, 'component2', 2);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (12, 'component3', 2);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (13, 'component1', 2);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (14, 'component2', 2);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (15, 'component3', 2);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (16, 'component1', 2);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (17, 'component2', 2);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (18, 'component3', 2);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (19, 'component1', 2);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (20, 'component2', 2);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (21, 'component3', 2);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (22, 'component1', 2);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (23, 'component2', 3);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (24, 'component3', 3);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (25, 'component1', 3);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (26, 'component2', 3);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (27, 'component3', 3);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (28, 'component1', 3);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (29, 'component2', 3);\n\nINSERT INTO components(id, name, frameid) \nVALUES \n  (30, 'component3', 3);\n","postgresDB":"60e8797.d0c1b88","output":true,"outputs":1,"x":795.0173568725586,"y":158.01040077209473,"wires":[[]]},{"id":"3c9f0b87.37d0e4","type":"postgrestor","z":"b42fd12f.306d4","name":"insert frames","query":"\nINSERT INTO frames(id, name) \nVALUES \n  (1, 'frame1');\n\nINSERT INTO frames(id, name) \nVALUES \n  (2, 'frame2');\n\nINSERT INTO frames(id, name) \nVALUES \n  (3, 'frame3');","postgresDB":"60e8797.d0c1b88","output":true,"outputs":1,"x":546.0173645019531,"y":157.01040124893188,"wires":[["733722d6.0c4d1c"]]},{"id":"b19b5c0b.2a12","type":"http in","z":"c314f908.4e5ca8","name":"","url":"/frames","method":"get","upload":false,"swaggerDoc":"","x":117.0173568725586,"y":245.01040649414062,"wires":[["342e42c8.590f9e"]]},{"id":"342e42c8.590f9e","type":"postgrestor","z":"c314f908.4e5ca8","name":"get frames","query":"SELECT * FROM FRAMES;","postgresDB":"60e8797.d0c1b88","output":true,"outputs":1,"x":345.01045989990234,"y":234.09373474121094,"wires":[["c4376b37.903e28"]]},{"id":"837a5c04.c9df7","type":"http response","z":"c314f908.4e5ca8","name":"","statusCode":"","headers":{},"x":855.0140266418457,"y":227.0972671508789,"wires":[]},{"id":"c4376b37.903e28","type":"change","z":"c314f908.4e5ca8","name":"","rules":[{"t":"set","p":"frames","pt":"global","to":"payload.rows","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"payload.rows","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":605.0034866333008,"y":235.3299217224121,"wires":[["837a5c04.c9df7"]]},{"id":"6845fce6.6d7894","type":"http in","z":"c314f908.4e5ca8","name":"","url":"/components","method":"get","upload":false,"swaggerDoc":"","x":135.0173568725586,"y":398.0104064941406,"wires":[["2730999b.1db3d6"]]},{"id":"2730999b.1db3d6","type":"postgrestor","z":"c314f908.4e5ca8","name":"get components","query":"SELECT * FROM COMPONENTS;","postgresDB":"60e8797.d0c1b88","output":true,"outputs":1,"x":353.01045989990234,"y":387.09373474121094,"wires":[["52da29a5.f68cc8"]]},{"id":"c5809bf5.9e9668","type":"http response","z":"c314f908.4e5ca8","name":"","statusCode":"","headers":{},"x":853.0140266418457,"y":380.0972671508789,"wires":[]},{"id":"52da29a5.f68cc8","type":"change","z":"c314f908.4e5ca8","name":"","rules":[{"t":"set","p":"components","pt":"global","to":"payload.rows","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"payload.rows","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":603.0034866333008,"y":388.3299217224121,"wires":[["c5809bf5.9e9668"]]},{"id":"2cdd2977.67aa26","type":"http in","z":"c314f908.4e5ca8","name":"","url":"/logs","method":"get","upload":false,"swaggerDoc":"","x":106.0173568725586,"y":545.0103759765625,"wires":[["4fa7eb50.610fe4"]]},{"id":"4fa7eb50.610fe4","type":"postgrestor","z":"c314f908.4e5ca8","name":"get logs","query":"SELECT * FROM LOGS ORDER BY ID DESC;","postgresDB":"60e8797.d0c1b88","output":true,"outputs":1,"x":334.01045989990234,"y":534.0937042236328,"wires":[["ba9ea0.9db1416"]]},{"id":"e3f95183.8a5d3","type":"http response","z":"c314f908.4e5ca8","name":"","statusCode":"","headers":{},"x":854.0140266418457,"y":527.0972366333008,"wires":[]},{"id":"ba9ea0.9db1416","type":"change","z":"c314f908.4e5ca8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.rows","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":604.0034866333008,"y":535.329891204834,"wires":[["e3f95183.8a5d3"]]},{"id":"eb72cc10.d78be","type":"inject","z":"650555c9.ffd16c","name":"","topic":"","payload":"","payloadType":"date","repeat":"1","crontab":"","once":true,"x":130.5208282470703,"y":63.95834732055664,"wires":[["d26d8571.00f1b8"]]},{"id":"d26d8571.00f1b8","type":"function","z":"650555c9.ffd16c","name":"modbus data","func":"msg.signals = [\n    false,\n    Math.random() > 0.5,\n    false,\n    true,\n    true,\n    true,\n    true,\n    true,\n    true,\n    true,\n    true\n];\n\nreturn msg;","outputs":1,"noerr":0,"x":147.52086639404297,"y":492.3854646682739,"wires":[["cca416c.23f31e8"]]},{"id":"3ff228e8.94a918","type":"rbe","z":"650555c9.ffd16c","name":"detect change","func":"rbe","gap":"","start":"","inout":"out","x":609.5242156982422,"y":262.02432918548584,"wires":[["f1847a76.fc7778"]]},{"id":"cca416c.23f31e8","type":"change","z":"650555c9.ffd16c","name":"stop signal","rules":[{"t":"set","p":"payload","pt":"msg","to":"signals[1]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":384.5173034667969,"y":262.4409809112549,"wires":[["3ff228e8.94a918"]]},{"id":"f1847a76.fc7778","type":"function","z":"650555c9.ffd16c","name":"if true","func":"if(msg.payload){\n return msg;\n}","outputs":1,"noerr":0,"x":819.5243320465088,"y":261.8229124546051,"wires":[["3f254637.cecf4a"]]},{"id":"1858aa77.190446","type":"postgrestor","z":"650555c9.ffd16c","name":"add log","query":"INSERT INTO LOGS (\n  frametype,\n  framenumber,\n  framecomponent,\n  shiftnumber,\n  processingtime,\n  status,\n  timestamp\n) \n\nVALUES (\n'{{msg.payload.frametype}}',\n'{{msg.payload.framenumber}}',\n'{{msg.payload.framecomponent}}',\n'{{msg.payload.shiftnumber}}',\n'{{msg.payload.processingtime}}',\n'{{msg.payload.status}}',\n'{{msg.payload.timestamp}}'\n);","postgresDB":"60e8797.d0c1b88","output":true,"outputs":1,"x":1606.0804252624512,"y":261.97923851013184,"wires":[[]]},{"id":"3f254637.cecf4a","type":"function","z":"650555c9.ffd16c","name":"generate data","func":"var components = global.get(\"components\");\nvar frameComponents = [];\n\nmsg.signals.shift();\nmsg.signals.shift();\nmsg.signals.shift();\n\nvar compData = msg.signals;\n\ncomponents.forEach(function(comp){\n    if(comp.frameid == global.get(\"selectedFrame\").id){\n        frameComponents.push(comp);\n    }\n});\n\nmsg.payload = [];\n\nvar frameSerial = parseInt(global.get(\"selectedFrame\")['serial']) + 1;\n\nvar isValid = compData.every(function(comp){\n    return comp === true ;\n});\n\n\nif(!isValid){\n    frameSerial = frameSerial - 1;\n}\n\ncompData.forEach(function(comp, key){\n    msg.payload.push({\n      frametype: global.get(\"selectedFrame\") ? global.get(\"selectedFrame\").name : '',\n      framenumber: isValid ? frameSerial: '---',\n      frameid: global.get(\"selectedFrame\")['id'],\n      framecomponent: frameComponents[key].name,\n      shiftnumber: getShift(),\n      processingtime: \"\",\n      status: comp === true ? \"ok\" : \"not ok\",\n      timestamp: new Date()\n    });\n});\n\n\nglobal.set(\"selectedFrame\", {\n  name: global.get(\"selectedFrame\").name,\n  id : global.get(\"selectedFrame\").id,\n  serial: frameSerial\n});\n\nmsg.topic = global.get(\"selectedFrame\");\n\nfunction getShift(){\n  var shifts = global.get(\"shifts\");\n  var shiftName = '';\n  var currentTime = new Date().toString().slice(16, 21);\n  \n  currentTime = parseInt(currentTime.replace(\":\", \"\"));\n  \n  for(var i = 0; i < shifts.length; i++){\n      var start = parseInt(shifts[i].starttime.replace(\":\", \"\"));\n      var end = parseInt(shifts[i].endtime.replace(\":\", \"\"));\n      \n      // Fix time for compare.\n      if (end < start) {\n          end += 2400;\n\n          if (!((currentTime >= start) && (currentTime <= end)))\n              currentTime += 2400;\n      }\n      \n      if(currentTime < end && currentTime >= start){\n          shiftName = shifts[i].name;\n          break;\n      }\n      \n  }\n  \n  return shiftName;\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":1073.180820465088,"y":262.15281343460083,"wires":[["7bd6d041.8809e","f89684ae.740bc8"]]},{"id":"d15d6785.236128","type":"inject","z":"c314f908.4e5ca8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"x":144.52430725097656,"y":45.96527862548828,"wires":[["4f2bf7a1.7e0328"]]},{"id":"b5c3f4c3.a14488","type":"inject","z":"c314f908.4e5ca8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"x":170.01734924316406,"y":184.01040649414062,"wires":[["342e42c8.590f9e"]]},{"id":"a462dc2b.3c63f","type":"inject","z":"c314f908.4e5ca8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"x":161.01734924316406,"y":329.0104064941406,"wires":[["2730999b.1db3d6"]]},{"id":"a42ae344.1ac24","type":"inject","z":"c314f908.4e5ca8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"x":160.01734924316406,"y":478.0104064941406,"wires":[["4fa7eb50.610fe4"]]},{"id":"a553059e.592a78","type":"http in","z":"c314f908.4e5ca8","name":"","url":"/selectedFrame","method":"put","upload":false,"swaggerDoc":"","x":140.01738739013672,"y":1199.6771478652954,"wires":[["dbba4366.77585"]]},{"id":"dbba4366.77585","type":"change","z":"c314f908.4e5ca8","name":"","rules":[{"t":"set","p":"selectedFrame","pt":"global","to":"req.body.selectedFrame","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":445.0173645019531,"y":1224.7883205413818,"wires":[["2e4e9f0c.a9f3f"]]},{"id":"ec15d262.32157","type":"http in","z":"c314f908.4e5ca8","name":"","url":"/selectedFrame","method":"get","upload":false,"swaggerDoc":"","x":142.0173797607422,"y":1125.8993697166443,"wires":[["520b936e.f9d96c"]]},{"id":"1e342ad9.1df205","type":"http response","z":"c314f908.4e5ca8","name":"","statusCode":"","headers":{},"x":849.0174007415771,"y":1125.8993577957153,"wires":[]},{"id":"520b936e.f9d96c","type":"change","z":"c314f908.4e5ca8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"selectedFrame","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":431.01734924316406,"y":1151.8993968963623,"wires":[["1e342ad9.1df205"]]},{"id":"2e4e9f0c.a9f3f","type":"http response","z":"c314f908.4e5ca8","name":"","statusCode":"","headers":{},"x":850.0173454284668,"y":1195.56609249115,"wires":[]},{"id":"a49e85e2.a9b2b8","type":"http in","z":"c314f908.4e5ca8","name":"","url":"/shifts","method":"get","upload":false,"swaggerDoc":"","x":111.0173568725586,"y":704.5659790039062,"wires":[["a7456dce.411f2"]]},{"id":"a7456dce.411f2","type":"postgrestor","z":"c314f908.4e5ca8","name":"get shifts","query":"SELECT * FROM SHIFTS;","postgresDB":"60e8797.d0c1b88","output":true,"outputs":1,"x":339.01045989990234,"y":693.6493072509766,"wires":[["b7318017.bac01"]]},{"id":"898046cc.bc55c8","type":"http response","z":"c314f908.4e5ca8","name":"","statusCode":"","headers":{},"x":859.0140266418457,"y":686.6528396606445,"wires":[]},{"id":"b7318017.bac01","type":"change","z":"c314f908.4e5ca8","name":"","rules":[{"t":"set","p":"shifts","pt":"global","to":"payload.rows","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"payload.rows","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":609.0034866333008,"y":694.8854942321777,"wires":[["898046cc.bc55c8"]]},{"id":"1d393a1d.f7bed6","type":"inject","z":"c314f908.4e5ca8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"x":165.01734924316406,"y":637.5660095214844,"wires":[["a7456dce.411f2"]]},{"id":"e0654901.0c6638","type":"http in","z":"c314f908.4e5ca8","name":"","url":"/shifts","method":"put","upload":false,"swaggerDoc":"","x":117.0173568725586,"y":829.5659790039062,"wires":[["7b149b25.2cf974"]]},{"id":"7b149b25.2cf974","type":"postgrestor","z":"c314f908.4e5ca8","name":"add shifts","query":"INSERT INTO SHIFTS(name, starttime, endtime)\n\nVALUES(\n'{{msg.req.body.name}}',\n'{{msg.req.body.starttime}}',\n'{{msg.req.body.endtime}}'\n)","postgresDB":"60e8797.d0c1b88","output":true,"outputs":1,"x":345.01045989990234,"y":818.6493072509766,"wires":[["d56eacb2.fc302","a7456dce.411f2"]]},{"id":"b309fdce.1d7de","type":"http response","z":"c314f908.4e5ca8","name":"","statusCode":"","headers":{},"x":865.0140266418457,"y":811.6528396606445,"wires":[]},{"id":"d56eacb2.fc302","type":"change","z":"c314f908.4e5ca8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.rows","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":615.0034866333008,"y":819.8854942321777,"wires":[["b309fdce.1d7de"]]},{"id":"3c93e48e.3d92ac","type":"http in","z":"c314f908.4e5ca8","name":"","url":"/shifts","method":"delete","upload":false,"swaggerDoc":"","x":110.0173568725586,"y":990.2326049804688,"wires":[["1a55bfa7.12248"]]},{"id":"1a55bfa7.12248","type":"postgrestor","z":"c314f908.4e5ca8","name":"delete shifts","query":"DELETE FROM SHIFTS WHERE id= '{{msg.req.query.id}}';","postgresDB":"60e8797.d0c1b88","output":true,"outputs":1,"x":338.01045989990234,"y":979.3159332275391,"wires":[["43cf6147.fa349","a7456dce.411f2"]]},{"id":"2b219761.3a2098","type":"http response","z":"c314f908.4e5ca8","name":"","statusCode":"","headers":{},"x":848.0140266418457,"y":972.319465637207,"wires":[]},{"id":"43cf6147.fa349","type":"change","z":"c314f908.4e5ca8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.rows","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":598.0034866333008,"y":980.5521202087402,"wires":[["2b219761.3a2098"]]},{"id":"cd7e84c4.53c008","type":"http in","z":"c314f908.4e5ca8","name":"","url":"/downloadLogs","method":"get","upload":false,"swaggerDoc":"","x":116.0173568725586,"y":1415.34375,"wires":[["f20b130.dbf5df"]]},{"id":"f20b130.dbf5df","type":"postgrestor","z":"c314f908.4e5ca8","name":"get logs","query":"SELECT * FROM LOGS ORDER BY ID;","postgresDB":"60e8797.d0c1b88","output":true,"outputs":1,"x":377.01049041748047,"y":1405.4273223876953,"wires":[["e50d7f92.ca82e"]]},{"id":"e3e9f364.97f1d","type":"http response","z":"c314f908.4e5ca8","name":"","statusCode":"","headers":{},"x":855.0141773223877,"y":1355.4307918548584,"wires":[]},{"id":"e50d7f92.ca82e","type":"change","z":"c314f908.4e5ca8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.rows","tot":"msg"},{"t":"set","p":"filepath","pt":"msg","to":"req.query.path","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":606.0034942626953,"y":1406.6632165908813,"wires":[["e3e9f364.97f1d","96cf7828.34e3d8","b16533e1.5480e"]]},{"id":"4cfc203c.bcf09","type":"inject","z":"c314f908.4e5ca8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":105.51388549804688,"y":1350.3056411743164,"wires":[["f20b130.dbf5df"]]},{"id":"96cf7828.34e3d8","type":"excel","z":"c314f908.4e5ca8","name":"","file":"","x":835.5242786407471,"y":1468.2535257339478,"wires":[[]]},{"id":"b16533e1.5480e","type":"debug","z":"c314f908.4e5ca8","name":"","active":false,"console":"false","complete":"true","x":783.5174102783203,"y":1563.9341201782227,"wires":[]},{"id":"12eb85db.5afb5a","type":"http in","z":"c314f908.4e5ca8","name":"","url":"/frame","method":"post","upload":false,"swaggerDoc":"","x":117.99998092651367,"y":287.6773052215576,"wires":[["7310d129.15814"]]},{"id":"7310d129.15814","type":"postgrestor","z":"c314f908.4e5ca8","name":"update frame","query":"UPDATE FRAMES\n\nSET serial = '{{msg.req.body.serial}}'\n\nWHERE id = '{{msg.req.body.id}}';","postgresDB":"60e8797.d0c1b88","output":true,"outputs":1,"x":341.9930877685547,"y":276.7607841491699,"wires":[["5b284a01.c71e84","342e42c8.590f9e","dbba4366.77585"]]},{"id":"5b284a01.c71e84","type":"http response","z":"c314f908.4e5ca8","name":"","statusCode":"","headers":{},"x":855.9966506958008,"y":269.7641658782959,"wires":[]},{"id":"7bd6d041.8809e","type":"postgrestor","z":"650555c9.ffd16c","name":"set framenumber","query":"UPDATE FRAMES\n\nSET serial = '{{msg.topic.serial}}'\n\nWHERE id = '{{msg.topic.id}}';","postgresDB":"60e8797.d0c1b88","output":true,"outputs":1,"x":1473.6329193115234,"y":371.26300048828125,"wires":[[]]},{"id":"f89684ae.740bc8","type":"split","z":"650555c9.ffd16c","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":1377.5209159851074,"y":253.8872127532959,"wires":[["1858aa77.190446"]]}]